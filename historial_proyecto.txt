==========================================================================
HISTORIAL DEL PROYECTO MOLIMEPI
==========================================================================

LTIMA ACTUALIZACIN: 22/03/2024
AUTOR: Asistente IA
==========================================================================

ESTRUCTURA DE LA BASE DE DATOS
------------------------------------------
Tabla: horarios_trabajo
- id (int11) AUTO_INCREMENT
- usuario_id (int11)
- fecha (date)
- hora_entrada (time NULL)
- hora_salida (time NULL)
- creado_en (timestamp)
- tipo enum('normal', 'descanso', 'baja', 'otros')
- horas_dia (int11)

CAMBIOS Y MEJORAS IMPLEMENTADAS
------------------------------------------

[22/03/2024] Mejora en Navegaci贸n para Empleados
- Eliminaci贸n del enlace "Inicio" en la barra de navegaci贸n para usuarios con rol de Empleado
- Redirecci贸n del logo MOLIMEPI a diferentes p谩ginas seg煤n el rol del usuario
- Reorganizaci贸n de elementos de navegaci贸n para mejorar la experiencia de usuario
- Prevenci贸n de intentos de acceso al dashboard por parte de empleados

[22/03/2024] Mejora en Control de Acceso
- Restricci贸n del acceso al dashboard solo para usuarios con rol Administrador
- Creaci贸n de p谩gina de acceso denegado con mensaje informativo
- Redirecci贸n autom谩tica para usuarios sin permisos suficientes
- Mejora en la seguridad general del sistema

[22/03/2024] Mejoras en Dashboard y Exportaci贸n a Excel
- Correcci贸n de visualizaci贸n de im谩genes de usuario en el dashboard
- Implementaci贸n de exportaci贸n a Excel sin librer铆as externas
- Visualizaci贸n detallada de horarios, vacaciones y horas extra por usuario
- C谩lculo autom谩tico de totales de horas y d铆as
- Mejora en la experiencia de usuario con modales interactivos
- Compatibilidad con diferentes versiones de Bootstrap

[17/03/2024] Gesti贸n de Tipos de Horarios
- Implementaci贸n de diferentes tipos de registro (normal, descanso, baja, otros)
- Modificaci贸n de la tabla para permitir valores NULL en hora_entrada y hora_salida
- C谩lculo autom谩tico de horas trabajadas para tipo 'normal'
- Visualizaci贸n diferenciada por colores en el calendario:
  * Normal: Azul (#007bff)
  * Descanso: Gris (#6c757d)
  * Baja: Blanco con texto rojo (#ffffff / #dc3545)
  * Otros: Gris (#6c757d)
- Iconos espec铆ficos para cada tipo:
  * Normal: Sin icono
  * Descanso: 
  * Baja: 
  * Otros: 锔

[17/03/2024] Mejoras en el Formulario de Horarios
- Validaci贸n din谩mica seg煤n el tipo de registro
- Campos de hora opcionales para tipos diferentes a 'normal'
- Prevenci贸n de superposici贸n de horarios
- Mejora en la interfaz de usuario del modal de edici贸n

[17/03/2024] Funcionalidad de Copia de Horarios
- Implementaci贸n de copia de horarios entre meses
- Validaci贸n de fechas v谩lidas
- Mantenimiento de tipos y horas en la copia
- Interfaz intuitiva para selecci贸n de mes origen y destino

VALIDACIONES IMPLEMENTADAS
------------------------------------------
1. Superposici贸n de Horarios
   - Verificaci贸n de horarios existentes para la misma fecha y usuario
   - Control espec铆fico para horarios tipo 'normal'

2. Tipos de Registro
   - Validaci贸n de tipos permitidos
   - Manejo espec铆fico de campos seg煤n tipo
   - C谩lculo autom谩tico de horas para tipo 'normal'

3. Formulario
   - Validaci贸n de campos requeridos seg煤n tipo
   - Verificaci贸n de rangos de hora v谩lidos
   - Control de duplicidad de registros

4. Visualizaci贸n de Im谩genes
   - Manejo de diferentes formatos de rutas (imgs/, public/imgs/)
   - Detecci贸n autom谩tica del formato de ruta
   - Visualizaci贸n de imagen por defecto cuando no existe

5. Control de Acceso
   - Verificaci贸n de roles de usuario
   - Restricci贸n de acceso basada en permisos
   - Redirecci贸n a p谩gina informativa en caso de acceso denegado
   - Mensajes claros sobre los motivos de restricci贸n

RECOMENDACIONES DE USO
------------------------------------------
1. Horarios Normales
   - Especificar hora de entrada y salida
   - Verificar que no haya superposici贸n
   - Las horas se calculan autom谩ticamente

2. Otros Tipos de Registro
   - No requieren hora de entrada ni salida
   - Solo se permite un registro por fecha y usuario
   - Se visualizan con colores e iconos distintivos

3. Copia de Horarios
   - Verificar mes origen y destino
   - Comprobar que los d铆as sean v谩lidos
   - Revisar los horarios copiados

4. Exportaci贸n a Excel
   - Seleccionar el mes y a帽o deseado antes de exportar
   - El archivo generado incluye informaci贸n detallada por usuario
   - Compatible con todas las versiones de Excel

5. Gesti贸n de Permisos
   - Solo los administradores pueden acceder al dashboard
   - Los empleados deben usar las vistas espec铆ficas para su rol
   - Contactar al administrador si se requieren permisos adicionales

PRXIMAS MEJORAS PLANIFICADAS
------------------------------------------
1. Visualizaci贸n
   - Mejora en la presentaci贸n del calendario
   - Filtros por tipo de registro
   - Vista consolidada por empleado

2. Funcionalidades
   - Reportes por tipo de registro
   - Estad铆sticas de horas trabajadas
   - Exportaci贸n de datos a PDF

3. Optimizaciones
   - Mejora en el rendimiento de consultas
   - Cach茅 de datos frecuentes
   - Validaciones del lado del cliente

==========================================================================
NOTAS TCNICAS
------------------------------------------
- Base de datos: MySQL/MariaDB
- Frontend: HTML5, JavaScript, jQuery, Bootstrap
- Backend: PHP
- Componentes: FullCalendar, SweetAlert2
- Versi贸n PHP m铆nima requerida: 7.4
========================================================================== 